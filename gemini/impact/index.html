<!DOCTYPE html>
<html lang="fr" prefix="og: https://ogp.me/ns#">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Terminal d'Impact — Intelligence Citoyenne | ouaisfieu</title>
  <meta name="description" content="Plateforme d'OSINT et d'analyse politique. Accédez aux dossiers d'intelligence citoyenne sans friction.">
  <meta name="robots" content="index, follow">
  
  <link rel="canonical" href="https://ouaisfieu.github.io/base/gemini/impact/" />

  <meta property="og:title" content="Terminal d'Impact — Intelligence Citoyenne" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://ouaisfieu.github.io/base/gemini/impact/" />
  
  <style>
    /* DESIGN SYSTEM V2 : Immersion "Dashboard" optimisée pour la lecture */
    :root {
      --bg-base: #020617;
      --bg-panel: rgba(15, 23, 42, 0.95);
      --accent: #22c55e;
      --accent-blue: #38bdf8;
      --text-main: #e2e8f0;
      --text-muted: #9ca3af;
      --border: rgba(51, 65, 85, 0.8);
      --font-ui: 'DM Sans', system-ui, sans-serif;
      --font-mono: 'Space Mono', 'Courier New', monospace;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: var(--bg-base); color: var(--text-main);
      font-family: var(--font-ui); height: 100vh;
      display: flex; flex-direction: column; overflow: hidden;
      background-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(15,23,42,0.15) 2px, rgba(15,23,42,0.15) 4px);
    }

    /* HEADER */
    header {
      background: rgba(3, 7, 18, 0.98); border-bottom: 1px solid var(--border);
      padding: 12px 20px; display: flex; justify-content: space-between; align-items: center;
      z-index: 20;
    }
    .brand { font-family: var(--font-mono); font-weight: bold; color: var(--accent); letter-spacing: 2px; }
    .status { font-family: var(--font-mono); font-size: 0.75rem; color: var(--accent-blue); }

    /* LAYOUT PRINCIPAL */
    main {
      flex: 1; display: grid; grid-template-columns: 280px 1fr 240px;
      overflow: hidden; position: relative; z-index: 10;
    }

    /* PANNEAUX LATERAUX */
    .sidebar, .rightbar { background: var(--bg-panel); overflow-y: auto; padding: 20px 15px; backdrop-filter: blur(10px); }
    .sidebar { border-right: 1px solid var(--border); }
    .rightbar { border-left: 1px solid var(--border); }

    .nav-title { font-family: var(--font-mono); font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 12px; letter-spacing: 0.1em; }
    
    .nav-item {
      display: block; padding: 12px; border-radius: 8px; margin-bottom: 8px;
      cursor: pointer; border: 1px solid rgba(148,163,184,0.1); transition: all 0.2s;
      background: rgba(2, 6, 23, 0.5);
    }
    .nav-item:hover { border-color: var(--accent-blue); transform: translateX(2px); }
    .nav-item.active { background: rgba(34, 197, 94, 0.1); border-color: var(--accent); border-left: 3px solid var(--accent); }
    .nav-item-title { font-weight: 600; font-size: 0.85rem; line-height: 1.3; }
    .nav-item-meta { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text-muted); margin-top: 6px; text-transform: uppercase; }

    /* ZONE DE LECTURE CENTRALE */
    .viewer {
      position: relative; overflow-y: auto; padding: 40px;
      background: radial-gradient(circle at top center, rgba(30,41,59,0.4), transparent 80%);
      scroll-behavior: smooth;
    }

    /* Styles pour le contenu injecté (On reprend tes styles de /base/) */
    #content-payload { max-width: 820px; margin: 0 auto; line-height: 1.72; font-size: 1rem; }
    #content-payload h1 { font-size: 2rem; margin-bottom: 12px; font-weight: 700; line-height: 1.2; }
    #content-payload .lead { font-size: 1.1rem; color: var(--text-muted); margin-bottom: 16px; }
    #content-payload h2 { font-size: 1.4rem; font-weight: 700; margin: 40px 0 16px; padding-bottom: 8px; border-bottom: 1px solid var(--border); }
    #content-payload h3 { font-size: 1.1rem; font-weight: 700; margin: 28px 0 12px; color: var(--accent); }
    #content-payload p { margin-bottom: 16px; }
    #content-payload a { color: var(--accent-blue); text-decoration: none; }
    #content-payload a:hover { color: var(--accent); }
    #content-payload .article-tag { font-family: var(--font-mono); font-size: 0.7rem; text-transform: uppercase; color: var(--accent-blue); border: 1px solid var(--accent-blue); padding: 3px 10px; border-radius: 4px; display: inline-block; margin-bottom: 12px; }
    #content-payload .article-meta { font-family: var(--font-mono); font-size: 0.72rem; color: var(--text-muted); display: flex; gap: 16px; flex-wrap: wrap; margin-bottom: 32px; padding-bottom: 32px; border-bottom: 1px solid var(--border); }
    #content-payload .data-box { background: rgba(15,23,42,0.8); border: 1px solid var(--border); border-radius: 10px; padding: 16px 20px; margin: 24px 0; font-family: var(--font-mono); font-size: 0.85rem; }
    #content-payload .data-title { font-weight: 700; color: var(--accent); margin-bottom: 8px; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.1em; }
    #content-payload blockquote { border-left: 3px solid var(--accent-blue); padding: 12px 20px; margin: 24px 0; background: rgba(15,23,42,0.8); font-style: italic; color: var(--text-muted); }
    #content-payload ul { margin: 0 0 16px 20px; }
    #content-payload .related, #content-payload .sources { display: none; } /* On cache les dossiers connexes car on a déjà le menu */

    /* LOADER & IFRAME EXTERNE */
    .loader { position: absolute; inset: 0; background: var(--bg-base); display: flex; align-items: center; justify-content: center; z-index: 10; opacity: 0; pointer-events: none; transition: 0.3s; }
    .loader.active { opacity: 1; pointer-events: auto; }
    .glitch { font-family: var(--font-mono); color: var(--accent); font-size: 1.2rem; letter-spacing: 2px; animation: blink 1s step-end infinite; }
    @keyframes blink { 50% { opacity: 0.5; } }

    #external-viewer { display: none; width: 100%; height: 100%; border: none; border-radius: 8px; }

    /* RESPONSIVE */
    @media (max-width: 1024px) { main { grid-template-columns: 250px 1fr; } .rightbar { display: none; } }
    @media (max-width: 768px) { main { grid-template-columns: 1fr; } .sidebar { display: none; } .viewer { padding: 20px; } }
  </style>
</head>
<body>

  <header>
    <div class="brand">O/F — TERMINAL D'IMPACT</div>
    <div class="status">. - Accréditation : Citoyen<br>. - Connexion : Sécurisée</div>
  </header>

  <main>
    <aside class="sidebar">
      <div class="nav-title">Base de Données (OSINT)</div>
      <div id="nav-container">
        </div>
    </aside>

    <section class="viewer" id="main-viewer">
      <div class="loader" id="loader"><span class="glitch">[ EXTRACTION DES DONNÉES... ]</span></div>
      
      <article id="content-payload">
        <h1 style="color:var(--accent-blue); font-family:var(--font-mono);">TERMINAL PRÊT</h1>
        <p class="lead">Bienvenue dans l'interface de lecture concentrée.</p>
        <div class="data-box">
          <div class="data-title">Instructions</div>
          <p>Sélectionnez un dossier dans le panneau de gauche pour en extraire le contenu. La navigation est furtive : aucun rechargement de page ne sera effectué.</p>
        </div>
      </article>

      <iframe id="external-viewer" src="about:blank"></iframe>
    </section>

    <aside class="rightbar">
      <div class="nav-title">Outils & Annexes</div>
      <div class="nav-item" onclick="loadExternal('https://boot-a-rat.vercel.app/')">
        <div class="nav-item-title">Intranet Détective</div>
        <div class="nav-item-meta">Application Externe</div>
      </div>
      <div class="nav-item" onclick="loadExternal('https://www.youtube-nocookie.com/embed/gk-dZo37IJA')">
        <div class="nav-item-title">DÉM·OS (Vidéo)</div>
        <div class="nav-item-meta">YouTube Embed</div>
      </div>
      <div class="nav-item" onclick="loadExternal('../../google.html')">
        <div class="nav-item-title">Le Site Ultime</div>
        <div class="nav-item-meta">Archive Niveau -1</div>
      </div>
    </aside>
  </main>

  <script>
    // LA BASE DE DONNÉES : Les chemins relatifs remontent de 2 dossiers (vers /base/)
    const database = [
      { id: "particratie", title: "La Particratie Belge", meta: "Analyse Politique", file: "../../particratie-belge.html" },
      { id: "budget", title: "Autopsie du Budget Arizona", meta: "Économie", file: "../../budget-arizona-belgique.html" },
      { id: "chomage", title: "Limitation Chômage 24 Mois", meta: "Exclusion", file: "../../chomage-limitation-24-mois.html" },
      { id: "malades", title: "Malades de Longue Durée", meta: "Santé Publique", file: "../../malades-longue-duree-belgique.html" },
      { id: "intelligence", title: "Intelligence Citoyenne", meta: "Méthodologie", file: "../../intelligence-citoyenne.html" },
      { id: "education", title: "Éducation Permanente", meta: "Éducation", file: "../../education-permanente-belgique.html" }
    ];

    const navContainer = document.getElementById('nav-container');
    const contentPayload = document.getElementById('content-payload');
    const externalViewer = document.getElementById('external-viewer');
    const loader = document.getElementById('loader');

    // 1. GÉNÉRER LE MENU
    function initNav() {
      database.forEach(doc => {
        const el = document.createElement('div');
        el.className = 'nav-item';
        el.id = `nav-${doc.id}`;
        el.innerHTML = `<div class="nav-item-title">${doc.title}</div><div class="nav-item-meta">${doc.meta}</div>`;
        el.onclick = () => loadInternal(doc.id);
        navContainer.appendChild(el);
      });
    }

    // 2. LE MOTEUR FETCH (Aspiration du contenu)
    async function loadInternal(id, pushState = true) {
      const doc = database.find(d => d.id === id);
      if(!doc) return;

      // UX: Activer le loader
      loader.classList.add('active');
      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      const activeNav = document.getElementById(`nav-${id}`);
      if(activeNav) activeNav.classList.add('active');
      
      externalViewer.style.display = 'none';
      contentPayload.style.display = 'block';

      // Modification de l'URL pour le partage (Deep Linking)
      if (pushState) {
        const newUrl = new URL(window.location);
        newUrl.searchParams.set('dossier', id);
        window.history.pushState({id: id}, '', newUrl);
      }

      try {
        // Aspiration du fichier physique
        const response = await fetch(doc.file);
        if (!response.ok) throw new Error('Fichier introuvable');
        const html = await response.text();

        // Création d'un DOM virtuel
        const parser = new DOMParser();
        const virtualDOM = parser.parseFromString(html, 'text/html');
        
        // On récupère uniquement l'en-tête (article-header) et le corps (article-body) de l'article !
        const headerObj = virtualDOM.querySelector('.article-header');
        const bodyObj = virtualDOM.querySelector('.article-body');

        if(headerObj && bodyObj) {
          contentPayload.innerHTML = headerObj.outerHTML + bodyObj.outerHTML;
        } else {
          // Fallback au cas où le fichier n'a pas exactement ces classes
          const wrapper = virtualDOM.querySelector('.wrapper');
          if(wrapper) {
            // On supprime manuellement les menus/footers pour ne garder que le texte
            const topnav = wrapper.querySelector('.topnav'); if(topnav) topnav.remove();
            const footer = wrapper.querySelector('.site-footer'); if(footer) footer.remove();
            const breadcrumb = wrapper.querySelector('.breadcrumb'); if(breadcrumb) breadcrumb.remove();
            contentPayload.innerHTML = wrapper.innerHTML;
          }
        }

        // LE COUP DE GÉNIE : On répare les liens internes !
        // Si un article pointe vers "particratie-belge.html", on transforme le lien pour qu'il ouvre l'article dans le Terminal
        contentPayload.querySelectorAll('a').forEach(a => {
          const href = a.getAttribute('href');
          if (href && !href.startsWith('http') && href.endsWith('.html')) {
            const targetDoc = database.find(d => d.file.includes(href));
            if (targetDoc) {
              a.href = `?dossier=${targetDoc.id}`;
              a.onclick = (e) => { e.preventDefault(); loadInternal(targetDoc.id); };
            } else {
              // Si le lien pointe vers un fichier non listé dans la BDD, on corrige le chemin
              a.href = `../../${href}`;
            }
          }
        });

        // Remonter en haut
        document.getElementById('main-viewer').scrollTop = 0;

      } catch (error) {
        contentPayload.innerHTML = `<h1 style="color:var(--accent);">ERREUR SYSTÈME</h1><p>Impossible d'extraire les données du fichier <code>${doc.file}</code>.</p>`;
      } finally {
        setTimeout(() => loader.classList.remove('active'), 250);
      }
    }

    // 3. CHARGER UN OUTIL EXTERNE (Iframe pour YouTube ou Appsmith)
    function loadExternal(url) {
      document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      contentPayload.style.display = 'none';
      externalViewer.style.display = 'block';
      
      const newUrl = new URL(window.location);
      newUrl.searchParams.delete('dossier');
      window.history.pushState({}, '', newUrl);

      loader.classList.add('active');
      externalViewer.onload = () => loader.classList.remove('active');
      externalViewer.src = url;
    }

    // 4. GESTION DU BOUTON PRÉCÉDENT DU NAVIGATEUR
    window.addEventListener("popstate", (event) => {
      const params = new URLSearchParams(window.location.search);
      const dossierId = params.get('dossier');
      if (dossierId) loadInternal(dossierId, false);
      else { 
        contentPayload.innerHTML = "<h1 style='color:var(--accent-blue);'>TERMINAL PRÊT</h1><p class='lead'>Sélectionnez un dossier.</p>"; 
        externalViewer.style.display = 'none'; 
        contentPayload.style.display = 'block'; 
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
      }
    });

    // 5. INITIALISATION AU DÉMARRAGE
    initNav();
    const initialParams = new URLSearchParams(window.location.search);
    const initialDossier = initialParams.get('dossier');
    if(initialDossier) {
      loadInternal(initialDossier, false);
    } else {
      // Par défaut, on ouvre l'article Particratie
      loadInternal("particratie", false);
    }
  </script>
</body>
</html>
